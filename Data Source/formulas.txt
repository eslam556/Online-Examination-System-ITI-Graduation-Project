ans: =IF(H2="MCQ", CHOOSE(RANDBETWEEN(1,3), "a", "b", "c"), IF(H2="TF", CHOOSE(RANDBETWEEN(1,2), "a", "b"), ""))

text: =INDEX([Choice.xlsx]Sheet1!$C$2:$C$1360, MATCH(1, ([Choice.xlsx]Sheet1!$B$2:$B$1360=B2)*([Choice.xlsx]Sheet1!$F$2:$F$1360=D2), 0))

corr: =INDEX([Choice.xlsx]Sheet1!$E$2:$E$1360, MATCH(1, ([Choice.xlsx]Sheet1!$B$2:$B$1360=B2)*([Choice.xlsx]Sheet1!$F$2:$F$1360=D2), 0))

type: =VLOOKUP(D2,Question.csv!$A:$E, 3)